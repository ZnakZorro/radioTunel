<html>
   <head>
      <title>btn</title>
<style>

 @charset "UTF-8";
button {
  padding: 10px 20px;
  border: 1px solid #ddd;
  background-color: #50bfff;
  color: #fff;
  margin:0.2em;
  border-radius: 0.8em;
  font-size: 12pt;
  font-family: "Verdana";
  cursor: pointer;
}
button.success {
  background-color: #13ce66;
  color: #fff;
}
  </style>
  <script type = "text/javascript" src = "js/vue.js"></script>
  <script>
let streamsDEF = 
[
{},
{"a":"0", "n": "TOK-FM","s":"http://pl-play.adtonos.com/tok-fm"},
{"a":"0", "n": "RNS",   "s":"http://stream.rcs.revma.com/ypqt40u0x1zuv"},
{"a":"0", "n": "357",   "s":"http://stream.rcs.revma.com/ye5kghkgcm0uv"},
{"a":"2", "n": "SwissJazz","s":"http://stream.srg-ssr.ch/m/rsj/mp3_128"},
{"a":"2", "n": "SwissClassic","s":"http://stream.srg-ssr.ch/m/rsc_de/mp3_128"},
{"a":"2", "n": "ClassicFM", "s":"http://media-the.musicradio.com/ClassicFM"},
{"a":"1", "n": "RMF_Cl","s":"http://www.rmfon.pl/n/rmfclassic.pls"},
{"a":"1", "n": "Dwojka","s":"http://mp3.polskieradio.pl:8952/;"},
{"a":"1", "n": "RockService","s":"http://stream.open.fm/379"},
{"a":"1", "n": "101 Jazz","s":"https://ais-sa2.cdnstream1.com/b22139_128mp3"},
{"a":"0", "n": "Szczecin","s":"http://stream4.nadaje.com:11986/prs.aac.m3u"},
{"a":"0", "n": "Anty-Radio","s":"https://an.cdn.eurozet.pl/ant-waw.mp3"}
];
console.log(streamsDEF);
</script>
   </head>
   <body>


<div id="app">
    <!--
    <span class="btn" v-for="i in 12">
      <button v-bind:data-st=`${i}`>bt-{{i}}</button>
    </span>
    -->
    <div id="info"></div>
  
      <h4>{{stacja}}/{{a}}, {{title}} = {{stream}} </h4>
      <button class="success" v-on:click = "radiosend" v-for="i in 10" v-bind:data-st=`${i}` v-bind:data-a=`${streams[i].a}` v-bind:data-stream=`${streams[i].s}` >{{streams[i].n}}</button>
   
  
</div>
     
     
<script>
var stacjeObject = new Vue({
    el: '#app',
    data: {
        name:"radioTunel",
        streams:streamsDEF,
        //titles:["kot","pies","małpa","słoń","b","c","a","b","c","a","b","c"],
        stacja:1,
        stream: null,
        title:  self.stacja,
        a:0
    },
    methods : {
       radiosend : function(event) {
          let a = event.target.dataset.a;
          let st = event.target.dataset.st;
          let stream = event.target.dataset.stream;
          let title  = event.target.textContent;
          console.log(st,a,title,stream);
          //console.log(this.stacja);
          //
          this.title=title;
          this.a=a;
          this.stacja=st;
          this.stream=stream;
          this.xradio();
       },
      xradio :  function() {
        let nr = parseInt(this.stacja)-1;
        let furl = "http://192.168.31.115/radio?t="+nr;
        console.log("furl=",furl);
        fetch(furl)
        .then(r => {return r.text()})
        .then(tx => {
          console.log(tx);
          let arr = tx.split("!");
          console.log(arr);
          let html = "<p>";
          arr.forEach((a)=>{
            html += a+"; ";
          });
          html += "</p>";
          document.getElementById("info").innerHTML = html;
        })
        .catch(e => {console.log(e)})
      },
      render : function() {
        this.stream = this.streams[1].s;
        this.title = this.streams[1].n;        
        
      }
    },
    mounted() {
      this.render();
    }  
});
  
</script>
